---
layout: post
title: 芯片内存保护
description: 看雪SDC笔记,先留个坑吧，等拿到PPT或者以后有机会接触真正的设备再补全,持续更新....
categories:  工控安全

---

<!-- more -->

# 密码保护

刚从看雪SDC回来,着实有点累,收获了很多知识,本文主要整理SDC里面讲的东西

## 密码机制保护突破

针对PLC

将核心算法dump

罗：登录PLC 创建新user 嗅探登录操作的流量，从控制器获取密码

施耐德：特殊内存读取，提取加密凭证，加密凭证下发创建会话链接->获取访问权限

西门子工控设备密码突破_S7-200：读取EEPRoM 更改1个字节的密码等级，伪造客户端夏装院士原始系统关键参数

烧写设备，校验，提取原bin文件中系统系统块参数，使用伪造的客户端封装系统块豹纹进行下装，让控制端自己计算正确的2字节校验值

从流量破开原始密码，授权算法：请求PLC rkey 返回22字节

获取交互报文->



S7Commplus V3 带有完整性校验与加密协议:流量

尝试从硬件Flash中获取信息

在线爆破->伪造客户端，控制器对于请求速率有限制，破解效率低

离线爆破->密码算法复杂度一般，但hash算法中salt

通过uart有诊断（后门）接口，执行任意代码，fuzzing。。



转储内存区，寻找密码信息，调试过程中替换密码hash值

hash传递攻击



硬件拆解，读取bin，寻找关键信息--熟悉硬件芯片，加密算法，精准定位



设计保护机制：

软件层面：加壳，虚拟保护技术

让PLC 认证PRA，

完整性校验，加密保护



关键敏感信息在可信区

双向认证

物理防护

密码强度



摒弃明文密码

流量中不携带极拿单加密的敏感信息

认证次数

去掉调试功能



# 芯片内存保护

读保护-防护突破

1.常见芯片固件提取

2.芯片内存保护攻击方法

3.低成本测信道攻击

4.芯片内存防护方案

MCU架构

SOC架构：蓝牙芯片，wifi芯片

SOC内存保护--配置字加密

作用：禁止调试

* 方法一：调试总线仲裁利用

SWD

* 方法二：地址总线复位向量利用

* 方法三：总线寄存器利用：

  使用调试器访问权限 

  重置CPU

  查看初始化寄存器

  单步执行

  查看寄存器值的变化

  根据权限的寄存器值查看

  * 低成本测信道攻击
* 在bootloader 过程中 跳过读保护的判断，根据测信道功耗查看复位功耗，明显功耗变化，VCC注入（故障注入）启动超压(控制在纳秒之内），使cpu休眠状态，跳过读保护
  * 收集研究数据表
* 确定电源

# 工具

* 控制器：推荐FPGA，注入控制器工作频率>= 被注入控制器工作频率

* 引脚切换：是推荐MAX4619，不要使用引脚切换供电

* 信号发生器

* 30V稳压器



